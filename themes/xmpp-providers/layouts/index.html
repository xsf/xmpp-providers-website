{{ define "main" }}

<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8 pb-4">
            <div class="px-4 py-2 my-5 text-center">
                <img class="d-block mx-auto mb-4" src="/images/xmpp-providers.svg" alt="" width="100">
                <h1 class="display-5 fw-bold">Introduction</h1>
                <div class="col-lg-8 mx-auto">
                    <p class="lead mb-4">Which XMPP provider suits you best?<br>This website offers a curated list of XMPP providers for you to choose from.</p>
                    <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                        <a class="btn btn-primary btn-lg px-4 gap-3" href="#providers" role="button">Browse Providers</a>
                        <a class="btn btn-outline-secondary btn-lg px-4" href="/faq" role="button">FAQ</a>
                    </div>
                </div>
            </div>
            <a id="providers"><h2 class="pb-2">Providers</h2></a>
            <div class="accordion" id="providers-accordion">
                {{ range $index, $content := sort .Site.Data.providers ".category" }}
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading-{{ $index }}">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-{{ $index }}" aria-expanded="false" aria-controls="collapse-{{ $index }}">
                                <span class="badge {{ if eq .category "A" }}category-a{{ else if eq .category "B" }}category-b{{ else if eq .category "C" }}category-c{{ else }}category-d{{ end }}">{{ .category }}</span>
                                <span class="text-body">&nbsp;&nbsp;{{ .jid }}</span>
                            </button>
                        </h2>
                        <div id="collapse-{{ $index }}" class="accordion-collapse collapse" aria-labelledby="heading-{{ $index }}" data-bs-parent="#providers-accordion">
                            <div class="accordion-body bg-light">
                                <div class="row">
                                    <div class="col-sm-6">
                                        <b>Compatibility / Security</b>
                                        <table>
                                            <tr>
                                                <td>
                                                    Compliance Tester
                                                </td>
                                                <td class="ps-3">
                                                    <a href="https://compliance.conversations.im/server/{{ .jid }}/" class="badge badge-rating text-light text-decoration-none {{ if gt .ratingXmppComplianceTester 99 }}category-a{{ else if gt .ratingXmppComplianceTester 89 }}category-c{{ else }}category-d{{ end }}" target="_blank">{{ .ratingXmppComplianceTester }}</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    IM Observatory (<a href="/faq#client-to-server" title="Client to Server" class="abbr">C2S</a>)
                                                </td>
                                                <td class="ps-3">
                                                    <a href="https://xmpp.net/result.php?domain={{ .jid }}&type=client" class="badge badge-rating text-light text-decoration-none {{ if eq .ratingImObservatoryClientToServer "A" }}category-a{{ else }}category-d{{ end }}" target="_blank">{{ .ratingImObservatoryClientToServer }}</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    IM Observatory (<a href="/faq#server-to-server" title="Server to Server" class="abbr">S2S</a>)
                                                </td>
                                                <td class="ps-3">
                                                    <a href="https://xmpp.net/result.php?domain={{ .jid }}&type=server" class="badge badge-rating text-light text-decoration-none {{ if eq .ratingImObservatoryServerToServer "A" }}category-a{{ else }}category-d{{ end }}" target="_blank">{{ .ratingImObservatoryServerToServer }}</a>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-sm-6">
                                        <b>Service</b>
                                        <table>
                                            <tr>
                                                <td class="text-center">
                                                    <i class="fa-solid fa-globe px-2 text-muted"></i>
                                                </td>
                                                <td>
                                                    Website:
                                                    {{ if .website }}
                                                        {{ $len := (len .website) }}
                                                        {{ $count := 0 }}
                                                        {{ range $lang, $address := .website }}
                                                            <a href="{{ $address }}" target="_blank">{{ upper $lang }}</a>
                                                            {{ $count = add $count 1 }}
                                                            {{ if ne $count $len }}
                                                                |
                                                            {{ end }}
                                                        {{ end }}
                                                    {{ else }}
                                                        ?
                                                    {{ end }}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-center">
                                                    <i class="fa-solid fa-dollar-sign px-2 text-muted"></i>
                                                </td>
                                                <td>
                                                    {{ if .freeOfCharge }}
                                                        Free of charge
                                                    {{ else }}
                                                        Paid
                                                    {{ end }}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-center">
                                                    <i class="fa-solid fa-location-dot px-2 text-muted"></i>
                                                </td>
                                                <td>
                                                    Server location(s):
                                                    {{ if .serverLocations }}
                                                        {{ $len := (len .serverLocations) }}
                                                        {{ $count := 0 }}
                                                        {{ range $index, $location := .serverLocations }}
                                                            {{ upper $location }}
                                                            {{ $count = add $count 1 }}
                                                            {{ if ne $count $len }}
                                                                |
                                                            {{ end }}
                                                        {{ end }}
                                                    {{ else }}
                                                        unknown
                                                    {{ end }}
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="row justify-content-center pt-3">
                                    <div class="col-sm-6 d-grid text-center">
                                        <a class="btn btn-outline-secondary btn-sm" href="/provider/{{ .jid }}" role="button">Details</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {{ end }}
            </div>
        </div>
    </div>
</div>
{{ end }}
